"use strict";(self.webpackChunkng_ant_admin=self.webpackChunkng_ant_admin||[]).push([[1076],{1076:(J,z,n)=>{n.r(z),n.d(z,{WebsocketComponent:()=>$});var W=n(1368),t=n(4496),w=n(4872),p=n(6504),x=n(3348),F=n(5072),S=n(460),v=n(5128),C=n(5584),f=n(2532),m=n(2605),I=n(8288),O=n(424),b=n(5657),D=n(1760),R=n(3252),j=n(6928),y=n(2540);const A={url:"",deserializer:a=>JSON.parse(a.data),serializer:a=>JSON.stringify(a)};class E extends b.G{constructor(e,s){if(super(),this._socket=null,e instanceof R._)this.destination=s,this.source=e;else{const i=this._config=Object.assign({},A);if(this._output=new b.E,"string"==typeof e)i.url=e;else for(const r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);if(!i.WebSocketCtor&&WebSocket)i.WebSocketCtor=WebSocket;else if(!i.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new y.o}}lift(e){const s=new E(this._config,this.destination);return s.operator=e,s.source=this,s}_resetState(){this._socket=null,this.source||(this.destination=new y.o),this._output=new b.E}multiplex(e,s,i){const r=this;return new R._(c=>{try{r.next(e())}catch(h){c.error(h)}const o=r.subscribe({next:h=>{try{i(h)&&c.next(h)}catch(u){c.error(u)}},error:h=>c.error(h),complete:()=>c.complete()});return()=>{try{r.next(s())}catch(h){c.error(h)}o.unsubscribe()}})}_connectSocket(){const{WebSocketCtor:e,protocol:s,url:i,binaryType:r}=this._config,c=this._output;let o=null;try{o=s?new e(i,s):new e(i),this._socket=o,r&&(this._socket.binaryType=r)}catch(u){return void c.error(u)}const h=new j.wH(()=>{this._socket=null,o&&1===o.readyState&&o.close()});o.onopen=u=>{const{_socket:d}=this;if(!d)return o.close(),void this._resetState();const{openObserver:T}=this._config;T&&T.next(u);const k=this.destination;this.destination=D.yR.create(l=>{if(1===o.readyState)try{const{serializer:g}=this._config;o.send(g(l))}catch(g){this.destination.error(g)}},l=>{const{closingObserver:g}=this._config;g&&g.next(void 0),l&&l.code?o.close(l.code,l.reason):c.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),this._resetState()},()=>{const{closingObserver:l}=this._config;l&&l.next(void 0),o.close(),this._resetState()}),k&&k instanceof y.o&&h.add(k.subscribe(this.destination))},o.onerror=u=>{this._resetState(),c.error(u)},o.onclose=u=>{o===this._socket&&this._resetState();const{closeObserver:d}=this._config;d&&d.next(u),u.wasClean?c.complete():c.error(u)},o.onmessage=u=>{try{const{deserializer:d}=this._config;c.next(d(u))}catch(d){c.error(d)}}}_subscribe(e){const{source:s}=this;return s?s.subscribe(e):(this._socket||this._connectSocket(),this._output.subscribe(e),e.add(()=>{const{_socket:i}=this;0===this._output.observers.length&&(i&&(1===i.readyState||0===i.readyState)&&i.close(),this._resetState())}),e)}unsubscribe(){const{_socket:e}=this;e&&(1===e.readyState||0===e.readyState)&&e.close(),this._resetState(),super.unsubscribe()}}var H=n(3064);function N(a,e){if(1&a&&(t.SAx(0),t.I0R(1,"div",10)(2,"span",11),t.OEk(3),t.C$Y()(),t.I0R(4,"div",12),t.OEk(5,"\u0110\xe3 \u0111\u1ecdc"),t.C$Y(),t.k70()),2&a){const s=e.$implicit;t.yG2(3),t.cNF(s)}}const Y=()=>[16,16],M=()=>({minRows:3,maxRows:5});let $=(()=>{class a{constructor(s){this.cdr=s,this.concate=!0,this.destroyRef=(0,t.uUt)(t.eM9),this.pageHeaderInfo={title:"websocket",breadcrumb:["Home","Ch\u1ee9c n\u0103ng","websocket"]},this.subject=function B(a){return new E(a)}(`ws://${x.ip}:8003/webSocket`),this.result=[],this.msg=""}send(){this.subject.next(this.msg),this.msg=""}end(){this.subject.complete(),this.concate=!1}ngOnInit(){}ngAfterViewInit(){this.subject.pipe((0,w.ay)(this.destroyRef)).subscribe(s=>{this.result.push(s.message),this.result=[...this.result],this.cdr.markForCheck()})}ngOnDestroy(){this.subject.complete()}static#t=this.\u0275fac=function(i){return new(i||a)(t.GI1(t.kD9))};static#e=this.\u0275cmp=t.In1({type:a,selectors:[["app-websocket"]],standalone:!0,features:[t.UHJ],decls:14,vars:8,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nz-row","",3,"nzGutter"],["nz-col","","nzFlex","300px"],["nz-input","","placeholder","M\xe1y ch\u1ee7 n\u1ed9i dung \u0111\xe3 g\u1eedi s\u1ebd quay tr\u1edf l\u1ea1i",1,"m-b-8",3,"nzAutosize","ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default",1,"m-l-8",3,"click"],["nz-col","","nzFlex","auto"],["nzTitle","N\u1ed9i dung tin nh\u1eafn"],[4,"ngFor","ngForOf"],["nz-result-content","",1,"m-t-0","p-8","text-break","m-b-8"],["nz-typography",""],["nz-typography","","nzType","secondary",1,"sp-12","text-right","m-t-5"]],template:function(i,r){1&i&&(t.wR5(0,"app-page-header",0),t.I0R(1,"div",1)(2,"div",2)(3,"div",3)(4,"textarea",4),t.iHE("ngModelChange",function(o){return t.kNx(r.msg,o)||(r.msg=o),o}),t.C$Y(),t.I0R(5,"button",5),t.qCj("click",function(){return r.send()}),t.OEk(6,"g\u1eedi"),t.C$Y(),t.I0R(7,"button",6),t.qCj("click",function(){return r.end()}),t.OEk(8,"Ng\u1eaft k\u1ebft n\u1ed1i"),t.C$Y(),t.I0R(9,"span"),t.OEk(10),t.C$Y()(),t.I0R(11,"div",7)(12,"nz-card",8),t.yuY(13,N,6,1,"ng-container",9),t.C$Y()()()()),2&i&&(t.E7m("pageHeaderInfo",r.pageHeaderInfo),t.yG2(2),t.E7m("nzGutter",t.q4q(6,Y)),t.yG2(2),t.E7m("nzAutosize",t.q4q(7,M)),t.OKB("ngModel",r.msg),t.yG2(6),t.oRS("Tr\u1ea1ng th\xe1i li\xean k\u1ebft ",r.concate,""),t.yG2(3),t.E7m("ngForOf",r.result))},dependencies:[F.Q,f.Ko,f.QD,f.ox,m.OA,m.cv,m.cL,p.y,p.ot,p.ue,p._G,S.EV,S.Ez,H.k,C.o9,C.gn,v.iq,v.Q9,W.Iw,I.k3,I.oZ,O.wx,O.ie],encapsulation:2,changeDetection:0})}return a})()}}]);