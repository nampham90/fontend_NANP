"use strict";(self.webpackChunkng_ant_admin=self.webpackChunkng_ant_admin||[]).push([[7819],{7819:(lt,D,i)=>{i.r(D),i.d(D,{DeptComponent:()=>it});var g=i(4755),t=i(2223),d=i(5855),s=i(9401),T=i(8746),Z=i(2195),J=i(4178),F=i(4895),S=i(1069),N=i(5656),C=i(8877),b=i(8442),v=i(4259),E=i(3642),A=i(4247),p=i(4701),m=i(1929),x=i(2701),u=i(8397),h=i(9470),M=i(8077),z=i(9646),y=i(4902),f=i(2839),L=i(8551);function Q(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.errors.message)}}function X(e,r){1&e&&(t.ynx(0),t._uU(1,"Ph\u1ea7n b\u1eaft bu\u1ed9c"),t.BQk())}function U(e,r){if(1&e&&(t.YNc(0,Q,2,1,"ng-container",10),t.YNc(1,X,2,0,"ng-container",10)),2&e){const n=r.$implicit;t.Q6J("ngIf",n.hasError("message")),t.xp6(1),t.Q6J("ngIf",n.hasError("required"))}}let Y=(()=>{class e{constructor(n,a){this.modalRef=n,this.fb=a,this.params={}}initForm(){this.addEditForm=this.fb.group({tenphongban:[null,[s.kI.required]],state:[!0],orderNum:[0]})}getAsyncFnData(n){return(0,z.of)(n)}getCurrentValue(){return(0,y.r7)(this.addEditForm)?(0,z.of)(this.addEditForm.value):(0,z.of)(!1)}ngOnInit(){this.initForm(),Object.keys(this.params).length>0&&this.addEditForm.patchValue(this.params)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(L.Lf),t.Y36(s.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dept-manage-modal"]],standalone:!0,features:[t.jDz],decls:22,vars:18,consts:[["nz-form","",3,"formGroup"],["nzRequired","","nzFor","tenphongban",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","formControlName","tenphongban","name","tenphongban","placeholder","Vui l\xf2ng nh\u1eadp t\xean ph\xf2ng ban","id","departmentName"],["nzRequired","","nzFor","state",3,"nzSm","nzXs"],["formControlName","state"],["nz-radio","",3,"nzValue"],["nzRequired","","nzFor","orderNum",3,"nzSm","nzXs"],["nz-input","","formControlName","orderNum","name","orderNum","placeholder","Lo\u1ea1i","id","orderNum"],["combineTpl",""],[4,"ngIf"]],template:function(n,a){if(1&n&&(t.TgZ(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),t._uU(3,"T\xean b\u1ed9 ph\u1eadn"),t.qZA(),t.TgZ(4,"nz-form-control",2),t._UZ(5,"input",3),t.qZA()(),t.TgZ(6,"nz-form-item")(7,"nz-form-label",4),t._uU(8,"T\xecnh tr\u1ea1ng b\u1ed9 ph\u1eadn"),t.qZA(),t.TgZ(9,"nz-form-control",2)(10,"nz-radio-group",5)(11,"label",6),t._uU(12,"V\xf4 hi\u1ec7u h\xf3a"),t.qZA(),t.TgZ(13,"label",6),t._uU(14,"Cho ph\xe9p"),t.qZA()()()(),t.TgZ(15,"nz-form-item")(16,"nz-form-label",7),t._uU(17,"Lo\u1ea1i"),t.qZA(),t.TgZ(18,"nz-form-control",2),t._UZ(19,"input",8),t.qZA()()(),t.YNc(20,U,2,2,"ng-template",null,9,t.W1O)),2&n){const o=t.MAs(21);t.Q6J("formGroup",a.addEditForm),t.xp6(2),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzErrorTip",o),t.xp6(3),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzErrorTip",o),t.xp6(2),t.Q6J("nzValue",!1),t.xp6(2),t.Q6J("nzValue",!0),t.xp6(3),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzErrorTip",o)}},dependencies:[s.u5,s._Y,s.Fj,s.JJ,s.JL,p.U5,m.t3,m.SK,p.Lr,p.Nx,p.iK,p.Fd,s.UX,s.sg,s.u,m.Jb,u.o7,u.Zp,f.aF,f.Of,f.Dg,g.O5],encapsulation:2,changeDetection:0}),e})();var O=i(7017);let I=(()=>{class e{constructor(n){this.modalWrapService=n}getContentComponent(){return Y}show(n={},a){return this.modalWrapService.show(this.getContentComponent(),n,a)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(O.U))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var P=i(374),V=i(3272),G=i(9085),H=i(2242);const R=["operationTpl"],B=["state"];function K(e,r){if(1&e&&t._UZ(0,"nz-option",22),2&e){const n=r.$implicit;t.Q6J("nzLabel",n.label)("nzValue",n.value)}}function W(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"span",24),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(),l=o.id,c=o.fatherId,_=t.oxw();return t.KtG(_.edit(l,c))}),t._uU(1,"C\u1eadp nh\u1eadt"),t.qZA()}}function j(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"span",24),t.NdJ("click",function(){t.CHM(n);const o=t.oxw().id,l=t.oxw();return t.KtG(l.del(o))}),t._uU(1,"X\xf3a"),t.qZA()}}function k(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"span",24),t.NdJ("click",function(){t.CHM(n);const o=t.oxw().id,l=t.oxw();return t.KtG(l.add(o))}),t._uU(1,"Th\xeam C\u1ea5p D\u01b0\u1edbi"),t.qZA()}}function w(e,r){if(1&e&&(t.YNc(0,W,2,0,"span",23),t.YNc(1,j,2,0,"span",23),t.YNc(2,k,2,0,"span",23)),2&e){const n=t.oxw();t.Q6J("appAuth",n.ActionCode.DeptEdit),t.xp6(1),t.Q6J("appAuth",n.ActionCode.DeptDel),t.xp6(1),t.Q6J("appAuth",n.ActionCode.DeptAddLowLevel)}}function $(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.add(0))}),t._UZ(1,"i",26),t._uU(2," Th\u1ebfm m\u1edbi "),t.qZA()}}function q(e,r){1&e&&t.GkF(0)}function tt(e,r){if(1&e&&t.YNc(0,q,1,0,"ng-container",27),2&e){const n=r.state;t.oxw();const a=t.MAs(34),o=t.MAs(36);t.Q6J("ngTemplateOutlet",n?a:o)}}function nt(e,r){1&e&&(t.TgZ(0,"nz-tag",28),t._uU(1,"Cho ph\xe9p"),t.qZA()),2&e&&t.Q6J("nzColor","green")}function et(e,r){1&e&&(t.TgZ(0,"nz-tag",28),t._uU(1,"V\xf4 hi\u1ec7u h\xf3a"),t.qZA()),2&e&&t.Q6J("nzColor","magenta")}const at=function(){return{"padding-bottom":0}},ot=function(){return{xs:8,sm:16,md:24}};let it=(()=>{class e{constructor(n,a,o,l,c,_,rt){this.fb=n,this.deptModalService=a,this.dataService=o,this.modalSrv=l,this.message=c,this.router=_,this.cdr=rt,this.ActionCode=Z.h,this.searchParam={},this.destroyRef=(0,t.f3M)(t.ktI),this.pageHeaderInfo={title:"Qu\u1ea3n l\xfd b\u1ed9 ph\u1eadn",breadcrumb:["Home","Qu\u1ea3n ly h\u1ec7 th\u1ed1ng","Qu\u1ea3n l\xfd b\u1ed9 ph\u1eadn"]},this.dataList=[],this.stateOptions=[]}reloadTable(){this.message.info("\u0110\xe3 \u0111\u01b0\u1ee3c l\xe0m m\u1edbi"),this.getDataList()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}tableLoading(n){this.tableConfig.loading=n,this.tableChangeDectction()}getDataList(n){this.tableConfig.loading=!0,this.dataService.getDepts({pageSize:0,pageNum:0,filters:this.searchParam}).pipe((0,T.x)(()=>{this.tableLoading(!1)}),(0,d.sL)(this.destroyRef)).subscribe(o=>{const l=(0,b.RA)(o.list);this.dataList=(0,b.Ll)(l),this.tableLoading(!1)})}check(n,a,o){this.message.success(n)}resetForm(){this.searchParam={},this.getDataList()}add(n){this.deptModalService.show({nzTitle:"\u65b0\u589e"}).pipe((0,d.sL)(this.destroyRef)).subscribe(a=>{if(!a||0===a.status)return;const o={...a.modalValue};o.fatherId=n,this.tableLoading(!0),this.addEditData(o,"addDepts")},a=>this.tableLoading(!1))}addEditData(n,a){this.dataService[a](n).pipe((0,T.x)(()=>{this.tableLoading(!1)}),(0,d.sL)(this.destroyRef)).subscribe(()=>{this.getDataList()})}del(n){const a=[n];this.modalSrv.confirm({nzTitle:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a kh\xf4ng\uff1f",nzContent:"Kh\xf4ng th\u1ec3 kh\xf4i ph\xfac khi x\xf3a",nzOnOk:()=>{this.tableLoading(!0),this.dataService.delDepts(a).pipe((0,d.sL)(this.destroyRef)).subscribe(()=>{1===this.dataList.length&&this.tableConfig.pageIndex--,this.getDataList()},o=>this.tableLoading(!1))}})}edit(n,a){this.dataService.getDeptsDetail(n).pipe((0,d.sL)(this.destroyRef)).subscribe(o=>{this.deptModalService.show({nzTitle:"\u7f16\u8f91"},o).pipe((0,d.sL)(this.destroyRef)).subscribe(({modalValue:l,status:c})=>{0!==c&&(l.id=n,l.fatherId=a,this.tableLoading(!0),this.addEditData(l,"editDepts"))},l=>this.tableLoading(!1))})}changePageSize(n){this.tableConfig.pageSize=n}initTable(){this.tableConfig={headers:[{title:"T\xean b\u1ed9 ph\u1eadn",width:180,field:"tenphongban"},{title:"Tr\u1ea1ng th\xe1i",field:"state",tdTemplate:this.state,width:100},{title:"Lo\u1ea1i",field:"orderNum",width:100},{title:"Ng\xe0y t\u1ea1o",field:"createdAt",pipe:"date:yyyy-MM-dd HH:mm",width:180},{title:"V\u1eadn h\xe0nh",tdTemplate:this.operationTpl,width:250,fixed:!0,fixedDir:"right"}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}ngOnInit(){this.initTable(),this.stateOptions=[...C.b.transformMapToArray(C.V.available,2)]}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(s.qu),t.Y36(I),t.Y36(P.z),t.Y36(L.Sf),t.Y36(V.dD),t.Y36(G.F0),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dept"]],viewQuery:function(n,a){if(1&n&&(t.Gf(R,7),t.Gf(B,7)),2&n){let o;t.iGM(o=t.CRH())&&(a.operationTpl=o.first),t.iGM(o=t.CRH())&&(a.state=o.first)}},standalone:!0,features:[t.jDz],decls:37,vars:31,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nzHoverable","",1,"m-b-10",3,"nzBodyStyle"],["nz-form",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],[3,"nzFor"],["name","departmentName","nz-input","","placeholder","Vui l\xf2ng nh\u1eadp t\xean b\u1ed9 ph\u1eadn",3,"ngModel","ngModelChange"],["name","state","nzAllowClear","","nzPlaceHolder","S\u1ed5 xu\u1ed1ng l\u1ef1a ch\u1ecdn",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","",1,"text-right","p-0","m-b-10",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","search"],["nz-button","",1,"m-l-15",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[3,"btnTpl","tableTitle","reload"],[3,"tableConfig","tableData","changePageNum","changePageSize"],["operationTpl",""],["tableBtns",""],["state",""],["yesTpl",""],["notTpl",""],[3,"nzLabel","nzValue"],["class","operate-text",3,"click",4,"appAuth"],[1,"operate-text",3,"click"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"],[4,"ngTemplateOutlet"],[3,"nzColor"]],template:function(n,a){if(1&n&&(t._UZ(0,"app-page-header",0),t.TgZ(1,"div",1)(2,"nz-card",2)(3,"form",3)(4,"div",4)(5,"div",5)(6,"nz-form-item")(7,"nz-form-label",6),t._uU(8,"T\xean b\u1ed9 ph\u1eadn"),t.qZA(),t.TgZ(9,"nz-form-control")(10,"input",7),t.NdJ("ngModelChange",function(l){return a.searchParam.departmentName=l}),t.qZA()()()(),t.TgZ(11,"div",5)(12,"nz-form-item")(13,"nz-form-label",6),t._uU(14,"Tr\u1ea1ng th\xe1i"),t.qZA(),t.TgZ(15,"nz-form-control")(16,"nz-select",8),t.NdJ("ngModelChange",function(l){return a.searchParam.state=l}),t.YNc(17,K,1,2,"nz-option",9),t.qZA()()()(),t.TgZ(18,"div",10)(19,"button",11),t.NdJ("click",function(){return a.getDataList()}),t._UZ(20,"i",12),t._uU(21," T\xecm ki\u1ebfm "),t.qZA(),t.TgZ(22,"button",13),t.NdJ("click",function(){return a.resetForm()}),t._UZ(23,"i",14),t._uU(24," c\xe0i l\u1ea1i "),t.qZA()()()()(),t.TgZ(25,"app-card-table-wrap",15),t.NdJ("reload",function(){return a.reloadTable()}),t.TgZ(26,"app-tree-table",16),t.NdJ("changePageNum",function(l){return a.getDataList(l)})("changePageSize",function(l){return a.changePageSize(l)}),t.qZA(),t.YNc(27,w,3,3,"ng-template",null,17,t.W1O),t.qZA()(),t.YNc(29,$,3,0,"ng-template",null,18,t.W1O),t.YNc(31,tt,1,1,"ng-template",null,19,t.W1O),t.YNc(33,nt,2,1,"ng-template",null,20,t.W1O),t.YNc(35,et,2,1,"ng-template",null,21,t.W1O)),2&n){const o=t.MAs(30);t.Q6J("pageHeaderInfo",a.pageHeaderInfo),t.xp6(2),t.Q6J("nzBodyStyle",t.DdM(29,at)),t.xp6(2),t.Q6J("nzGutter",t.DdM(30,ot)),t.xp6(1),t.Q6J("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),t.xp6(5),t.Q6J("ngModel",a.searchParam.departmentName),t.xp6(1),t.Q6J("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),t.xp6(5),t.Q6J("ngModel",a.searchParam.state),t.xp6(1),t.Q6J("ngForOf",a.stateOptions),t.xp6(1),t.Q6J("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),t.xp6(1),t.Q6J("nzType","primary"),t.xp6(6),t.Q6J("btnTpl",o)("tableTitle","Danh s\xe1ch b\u1ed9 ph\u1eadn"),t.xp6(1),t.Q6J("tableConfig",a.tableConfig)("tableData",a.dataList)}},dependencies:[F.q,E.vh,E.bd,s.u5,s._Y,s.Fj,s.JJ,s.JL,s.On,s.F,p.U5,m.t3,m.SK,p.Lr,p.Nx,p.iK,p.Fd,m.Jb,u.o7,u.Zp,h.LV,h.Ip,h.Vq,g.ax,v.sL,v.ix,H.w,A.dQ,A.vG,x.PV,x.Ls,J.p,S.I,N.x,g.tP,M.X,M.j],encapsulation:2,changeDetection:0}),e})()}}]);