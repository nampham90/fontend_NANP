"use strict";(self.webpackChunkng_ant_admin=self.webpackChunkng_ant_admin||[]).push([[2604],{2604:(Q,v,o)=>{o.r(v),o.d(v,{WebsocketComponent:()=>H});var A=o(4755),t=o(2223),D=o(5855),g=o(9401),O=o(9019),F=o(4895),E=o(4259),S=o(3642),T=o(4247),f=o(1929),m=o(8397),x=o(7908),C=o(7267),b=o(7579),J=o(930),W=o(9751),j=o(727),y=o(4707);const w={url:"",deserializer:c=>JSON.parse(c.data),serializer:c=>JSON.stringify(c)};class z extends b.u{constructor(e,n){if(super(),this._socket=null,e instanceof W.y)this.destination=n,this.source=e;else{const s=this._config=Object.assign({},w);if(this._output=new b.x,"string"==typeof e)s.url=e;else for(const a in e)e.hasOwnProperty(a)&&(s[a]=e[a]);if(!s.WebSocketCtor&&WebSocket)s.WebSocketCtor=WebSocket;else if(!s.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new y.t}}lift(e){const n=new z(this._config,this.destination);return n.operator=e,n.source=this,n}_resetState(){this._socket=null,this.source||(this.destination=new y.t),this._output=new b.x}multiplex(e,n,s){const a=this;return new W.y(i=>{try{a.next(e())}catch(h){i.error(h)}const r=a.subscribe({next:h=>{try{s(h)&&i.next(h)}catch(u){i.error(u)}},error:h=>i.error(h),complete:()=>i.complete()});return()=>{try{a.next(n())}catch(h){i.error(h)}r.unsubscribe()}})}_connectSocket(){const{WebSocketCtor:e,protocol:n,url:s,binaryType:a}=this._config,i=this._output;let r=null;try{r=n?new e(s,n):new e(s),this._socket=r,a&&(this._socket.binaryType=a)}catch(u){return void i.error(u)}const h=new j.w0(()=>{this._socket=null,r&&1===r.readyState&&r.close()});r.onopen=u=>{const{_socket:d}=this;if(!d)return r.close(),void this._resetState();const{openObserver:Z}=this._config;Z&&Z.next(u);const k=this.destination;this.destination=J.Lv.create(l=>{if(1===r.readyState)try{const{serializer:p}=this._config;r.send(p(l))}catch(p){this.destination.error(p)}},l=>{const{closingObserver:p}=this._config;p&&p.next(void 0),l&&l.code?r.close(l.code,l.reason):i.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),this._resetState()},()=>{const{closingObserver:l}=this._config;l&&l.next(void 0),r.close(),this._resetState()}),k&&k instanceof y.t&&h.add(k.subscribe(this.destination))},r.onerror=u=>{this._resetState(),i.error(u)},r.onclose=u=>{r===this._socket&&this._resetState();const{closeObserver:d}=this._config;d&&d.next(u),u.wasClean?i.complete():i.error(u)},r.onmessage=u=>{try{const{deserializer:d}=this._config;i.next(d(u))}catch(d){i.error(d)}}}_subscribe(e){const{source:n}=this;return n?n.subscribe(e):(this._socket||this._connectSocket(),this._output.subscribe(e),e.add(()=>{const{_socket:s}=this;0===this._output.observers.length&&(s&&(1===s.readyState||0===s.readyState)&&s.close(),this._resetState())}),e)}unsubscribe(){const{_socket:e}=this;e&&(1===e.readyState||0===e.readyState)&&e.close(),this._resetState(),super.unsubscribe()}}var B=o(2242);function M(c,e){if(1&c&&(t.ynx(0),t.TgZ(1,"div",10)(2,"span",11),t._uU(3),t.qZA()(),t.TgZ(4,"div",12),t._uU(5,"\u0110\xe3 \u0111\u1ecdc"),t.qZA(),t.BQk()),2&c){const n=e.$implicit;t.xp6(3),t.Oqu(n)}}const U=function(){return[16,16]},R=function(){return{minRows:3,maxRows:5}};let H=(()=>{class c{constructor(n){this.cdr=n,this.concate=!0,this.destroyRef=(0,t.f3M)(t.ktI),this.pageHeaderInfo={title:"websocket",breadcrumb:["Home","Ch\u1ee9c n\u0103ng","websocket"]},this.subject=function N(c){return new z(c)}(`ws://${O.ip}:8003/webSocket`),this.result=[],this.msg=""}send(){this.subject.next(this.msg),this.msg=""}end(){this.subject.complete(),this.concate=!1}ngOnInit(){}ngAfterViewInit(){this.subject.pipe((0,D.sL)(this.destroyRef)).subscribe(n=>{this.result.push(n.message),this.result=[...this.result],this.cdr.markForCheck()})}ngOnDestroy(){this.subject.complete()}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(t.sBO))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-websocket"]],standalone:!0,features:[t.jDz],decls:14,vars:8,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nz-row","",3,"nzGutter"],["nz-col","","nzFlex","300px"],["nz-input","","placeholder","M\xe1y ch\u1ee7 n\u1ed9i dung \u0111\xe3 g\u1eedi s\u1ebd quay tr\u1edf l\u1ea1i",1,"m-b-8",3,"nzAutosize","ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default",1,"m-l-8",3,"click"],["nz-col","","nzFlex","auto"],["nzTitle","N\u1ed9i dung tin nh\u1eafn"],[4,"ngFor","ngForOf"],["nz-result-content","",1,"m-t-0","p-8","text-break","m-b-8"],["nz-typography",""],["nz-typography","","nzType","secondary",1,"sp-12","text-right","m-t-5"]],template:function(n,s){1&n&&(t._UZ(0,"app-page-header",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"textarea",4),t.NdJ("ngModelChange",function(i){return s.msg=i}),t.qZA(),t.TgZ(5,"button",5),t.NdJ("click",function(){return s.send()}),t._uU(6,"g\u1eedi"),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){return s.end()}),t._uU(8,"Ng\u1eaft k\u1ebft n\u1ed1i"),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA()(),t.TgZ(11,"div",7)(12,"nz-card",8),t.YNc(13,M,6,1,"ng-container",9),t.qZA()()()()),2&n&&(t.Q6J("pageHeaderInfo",s.pageHeaderInfo),t.xp6(2),t.Q6J("nzGutter",t.DdM(6,U)),t.xp6(2),t.Q6J("nzAutosize",t.DdM(7,R))("ngModel",s.msg),t.xp6(6),t.hij("Tr\u1ea1ng th\xe1i li\xean k\u1ebft ",s.concate,""),t.xp6(3),t.Q6J("ngForOf",s.result))},dependencies:[F.q,f.Jb,f.t3,f.SK,m.o7,m.Zp,m.rh,g.u5,g.Fj,g.JJ,g.On,E.sL,E.ix,B.w,T.dQ,T.vG,S.vh,S.bd,A.ax,x.XD,x.HO,C.ZJ,C.ZU],encapsulation:2,changeDetection:0}),c})()}}]);