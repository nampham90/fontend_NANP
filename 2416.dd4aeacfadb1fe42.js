"use strict";(self.webpackChunkng_ant_admin=self.webpackChunkng_ant_admin||[]).push([[2416],{2416:(it,E,i)=>{i.r(E),i.d(E,{DeptComponent:()=>at});var h=i(1368),t=i(4496),d=i(4872),s=i(6504),_=i(8824),O=i(472),I=i(1864),S=i(2624),R=i(5072),L=i(4304),M=i(872),D=i(7436),y=i(4984),F=i(7340),g=i(2700),X=i(788),m=i(1752),c=i(2532),u=i(2605),z=i(9116),f=i(2217);function Y(e,l){if(1&e&&(t.SAx(0),t.OEk(1),t.k70()),2&e){const n=t.GaO().$implicit;t.yG2(),t.cNF(n.errors.message)}}function N(e,l){1&e&&(t.SAx(0),t.OEk(1,"Ph\u1ea7n b\u1eaft bu\u1ed9c"),t.k70())}function k(e,l){if(1&e&&t.yuY(0,Y,2,1,"ng-container",10)(1,N,2,0,"ng-container",10),2&e){const n=l.$implicit;t.E7m("ngIf",n.hasError("message")),t.yG2(),t.E7m("ngIf",n.hasError("required"))}}let $=(()=>{class e{constructor(n){this.modalRef=n,this.nzModalData=(0,t.uUt)(z.aG),this.fb=(0,t.uUt)(s.im),this.params={}}initForm(){this.addEditForm=this.fb.group({tenphongban:[null,[s.AQ.required]],state:[!0],orderNum:[0]})}getAsyncFnData(n){return(0,g.of)(n)}getCurrentValue(){return(0,X.qg)(this.addEditForm)?(0,g.of)(this.addEditForm.value):(0,g.of)(!1)}ngOnInit(){this.initForm(),this.nzModalData&&this.addEditForm.patchValue(this.nzModalData)}static#t=this.\u0275fac=function(o){return new(o||e)(t.GI1(z.U7))};static#n=this.\u0275cmp=t.In1({type:e,selectors:[["app-dept-manage-modal"]],standalone:!0,features:[t.UHJ],decls:22,vars:18,consts:[["nz-form","",3,"formGroup"],["nzRequired","","nzFor","tenphongban",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","formControlName","tenphongban","name","tenphongban","placeholder","Vui l\xf2ng nh\u1eadp t\xean ph\xf2ng ban","id","departmentName"],["nzRequired","","nzFor","state",3,"nzSm","nzXs"],["formControlName","state"],["nz-radio","",3,"nzValue"],["nzRequired","","nzFor","orderNum",3,"nzSm","nzXs"],["nz-input","","formControlName","orderNum","name","orderNum","placeholder","Lo\u1ea1i","id","orderNum"],["combineTpl",""],[4,"ngIf"]],template:function(o,a){if(1&o&&(t.I0R(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),t.OEk(3,"T\xean b\u1ed9 ph\u1eadn"),t.C$Y(),t.I0R(4,"nz-form-control",2),t.wR5(5,"input",3),t.C$Y()(),t.I0R(6,"nz-form-item")(7,"nz-form-label",4),t.OEk(8,"T\xecnh tr\u1ea1ng b\u1ed9 ph\u1eadn"),t.C$Y(),t.I0R(9,"nz-form-control",2)(10,"nz-radio-group",5)(11,"label",6),t.OEk(12,"V\xf4 hi\u1ec7u h\xf3a"),t.C$Y(),t.I0R(13,"label",6),t.OEk(14,"Cho ph\xe9p"),t.C$Y()()()(),t.I0R(15,"nz-form-item")(16,"nz-form-label",7),t.OEk(17,"Lo\u1ea1i"),t.C$Y(),t.I0R(18,"nz-form-control",2),t.wR5(19,"input",8),t.C$Y()()(),t.yuY(20,k,2,2,"ng-template",null,9,t.gJz)),2&o){const r=t.Gew(21);t.E7m("formGroup",a.addEditForm),t.yG2(2),t.E7m("nzSm",6)("nzXs",24),t.yG2(2),t.E7m("nzSm",14)("nzXs",24)("nzErrorTip",r),t.yG2(3),t.E7m("nzSm",6)("nzXs",24),t.yG2(2),t.E7m("nzSm",14)("nzXs",24)("nzErrorTip",r),t.yG2(2),t.E7m("nzValue",!1),t.yG2(2),t.E7m("nzValue",!0),t.yG2(3),t.E7m("nzSm",6)("nzXs",24),t.yG2(2),t.E7m("nzSm",14)("nzXs",24)("nzErrorTip",r)}},dependencies:[s.y,s.sz,s.ot,s.ue,s.u,m.WO,c.QD,c.ox,m.BN,m.qU,m.Qo,m.YZ,s.sl,s.uW,s.Wo,c.Ko,u.OA,u.cv,f.sn,f.es,f.uw,h.u_],encapsulation:2,changeDetection:0})}return e})(),x=(()=>{class e{constructor(){this.modalWrapService=(0,t.uUt)(F.K)}getContentComponent(){return $}show(n={},o){return this.modalWrapService.show(this.getContentComponent(),n,o)}static#t=this.\u0275fac=function(o){return new(o||e)};static#n=this.\u0275prov=t.wxM({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var T=i(460),b=i(5128),v=i(5584),G=i(6088),P=i(9432),C=i(268),A=i(2992),U=i(3064);const Q=["operationTpl"],V=["state"];function B(e,l){if(1&e&&t.wR5(0,"nz-option",22),2&e){const n=l.$implicit;t.E7m("nzLabel",n.label)("nzValue",n.value)}}function H(e,l){if(1&e){const n=t.KQA();t.I0R(0,"span",24),t.qCj("click",function(){t.usT(n);const a=t.GaO(),r=a.id,p=a.fatherId,ot=t.GaO();return t.CGJ(ot.edit(r,p))}),t.OEk(1,"C\u1eadp nh\u1eadt"),t.C$Y()}}function J(e,l){if(1&e){const n=t.KQA();t.I0R(0,"span",24),t.qCj("click",function(){t.usT(n);const a=t.GaO().id,r=t.GaO();return t.CGJ(r.del(a))}),t.OEk(1,"X\xf3a"),t.C$Y()}}function w(e,l){if(1&e){const n=t.KQA();t.I0R(0,"span",24),t.qCj("click",function(){t.usT(n);const a=t.GaO().id,r=t.GaO();return t.CGJ(r.add(a))}),t.OEk(1,"Th\xeam C\u1ea5p D\u01b0\u1edbi"),t.C$Y()}}function K(e,l){if(1&e&&t.yuY(0,H,2,0,"span",23)(1,J,2,0,"span",23)(2,w,2,0,"span",23),2&e){const n=t.GaO();t.E7m("appAuth",n.ActionCode.DeptEdit),t.yG2(),t.E7m("appAuth",n.ActionCode.DeptDel),t.yG2(),t.E7m("appAuth",n.ActionCode.DeptAddLowLevel)}}function j(e,l){if(1&e){const n=t.KQA();t.I0R(0,"button",25),t.qCj("click",function(){t.usT(n);const a=t.GaO();return t.CGJ(a.add(0))}),t.wR5(1,"i",26),t.OEk(2," Th\u1ebfm m\u1edbi "),t.C$Y()}}function W(e,l){1&e&&t.C_f(0)}function Z(e,l){if(1&e&&t.yuY(0,W,1,0,"ng-container",27),2&e){const n=l.state;t.GaO();const o=t.Gew(34),a=t.Gew(36);t.E7m("ngTemplateOutlet",n?o:a)}}function q(e,l){1&e&&(t.I0R(0,"nz-tag",28),t.OEk(1,"Cho ph\xe9p"),t.C$Y()),2&e&&t.E7m("nzColor","green")}function tt(e,l){1&e&&(t.I0R(0,"nz-tag",28),t.OEk(1,"V\xf4 hi\u1ec7u h\xf3a"),t.C$Y()),2&e&&t.E7m("nzColor","magenta")}const nt=()=>({"padding-bottom":0}),et=()=>({xs:8,sm:16,md:24});let at=(()=>{class e{constructor(){this.deptModalService=(0,t.uUt)(x),this.dataService=(0,t.uUt)(I.G),this.modalSrv=(0,t.uUt)(z.mU),this.message=(0,t.uUt)(P.yo),this.cdr=(0,t.uUt)(t.kD9),this.ActionCode=O.i,this.searchParam={},this.destroyRef=(0,t.uUt)(t.eM9),this.pageHeaderInfo={title:"Qu\u1ea3n l\xfd b\u1ed9 ph\u1eadn",breadcrumb:["Home","Qu\u1ea3n ly h\u1ec7 th\u1ed1ng","Qu\u1ea3n l\xfd b\u1ed9 ph\u1eadn"]},this.dataList=[],this.stateOptions=[]}reloadTable(){this.message.info("\u0110\xe3 \u0111\u01b0\u1ee3c l\xe0m m\u1edbi"),this.getDataList()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}tableLoading(n){this.tableConfig.loading=n,this.tableChangeDectction()}getDataList(n){this.tableConfig.loading=!0,this.dataService.getDepts({pageSize:0,pageNum:0,filters:this.searchParam}).pipe((0,_.U)(()=>{this.tableLoading(!1)}),(0,d.ay)(this.destroyRef)).subscribe(a=>{const r=(0,y.ot)(a.list);this.dataList=(0,y.q0)(r),this.tableLoading(!1)})}check(n,o,a){this.message.success(n)}resetForm(){this.searchParam={},this.getDataList()}add(n){this.deptModalService.show({nzTitle:"Th\xeam m\u1edbi"}).pipe((0,d.ay)(this.destroyRef)).subscribe(o=>{if(!o||0===o.status)return;const a={...o.modalValue};a.fatherId=n,this.tableLoading(!0),this.addEditData(a,"addDepts")},o=>this.tableLoading(!1))}addEditData(n,o){this.dataService[o](n).pipe((0,_.U)(()=>{this.tableLoading(!1)}),(0,d.ay)(this.destroyRef)).subscribe(()=>{this.getDataList()})}del(n){this.modalSrv.confirm({nzTitle:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a kh\xf4ng\uff1f",nzContent:"Kh\xf4ng th\u1ec3 kh\xf4i ph\xfac khi x\xf3a",nzOnOk:()=>{this.tableLoading(!0),this.dataService.delDepts(n).pipe((0,d.ay)(this.destroyRef)).subscribe(()=>{1===this.dataList.length&&this.tableConfig.pageIndex--,this.getDataList()},o=>this.tableLoading(!1))}})}edit(n,o){this.dataService.getDeptsDetail(n).pipe((0,d.ay)(this.destroyRef)).subscribe(a=>{this.deptModalService.show({nzTitle:"C\u1eadp nh\u1eadt"},a).pipe((0,d.ay)(this.destroyRef)).subscribe(({modalValue:r,status:p})=>{0!==p&&(r.id=n,r.fatherId=o,this.tableLoading(!0),this.addEditData(r,"editDepts"))},r=>this.tableLoading(!1))})}changePageSize(n){this.tableConfig.pageSize=n}initTable(){this.tableConfig={headers:[{title:"T\xean b\u1ed9 ph\u1eadn",width:180,field:"tenphongban"},{title:"Tr\u1ea1ng th\xe1i",field:"state",tdTemplate:this.state,width:100},{title:"Lo\u1ea1i",field:"orderNum",width:100},{title:"Ng\xe0y t\u1ea1o",field:"createdAt",pipe:"date:yyyy-MM-dd HH:mm",width:180},{title:"V\u1eadn h\xe0nh",tdTemplate:this.operationTpl,width:250,fixed:!0,fixedDir:"right"}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}ngOnInit(){this.initTable(),this.stateOptions=[...D.e.transformMapToArray(D.c.available,2)]}static#t=this.\u0275fac=function(o){return new(o||e)};static#n=this.\u0275cmp=t.In1({type:e,selectors:[["app-dept"]],viewQuery:function(o,a){if(1&o&&(t.CC$(Q,7),t.CC$(V,7)),2&o){let r;t.wto(r=t.Gqi())&&(a.operationTpl=r.first),t.wto(r=t.Gqi())&&(a.state=r.first)}},standalone:!0,features:[t.UHJ],decls:37,vars:31,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nzHoverable","",1,"m-b-10",3,"nzBodyStyle"],["nz-form",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],[3,"nzFor"],["name","departmentName","nz-input","","placeholder","Vui l\xf2ng nh\u1eadp t\xean b\u1ed9 ph\u1eadn",3,"ngModel","ngModelChange"],["name","state","nzAllowClear","","nzPlaceHolder","S\u1ed5 xu\u1ed1ng l\u1ef1a ch\u1ecdn",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","",1,"text-right","p-0","m-b-10",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","search"],["nz-button","",1,"m-l-15",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[3,"btnTpl","tableTitle","reload"],[3,"tableConfig","tableData","changePageNum","changePageSize"],["operationTpl",""],["tableBtns",""],["state",""],["yesTpl",""],["notTpl",""],[3,"nzLabel","nzValue"],["class","operate-text",3,"click",4,"appAuth"],[1,"operate-text",3,"click"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"],[4,"ngTemplateOutlet"],[3,"nzColor"]],template:function(o,a){if(1&o&&(t.wR5(0,"app-page-header",0),t.I0R(1,"div",1)(2,"nz-card",2)(3,"form",3)(4,"div",4)(5,"div",5)(6,"nz-form-item")(7,"nz-form-label",6),t.OEk(8,"T\xean b\u1ed9 ph\u1eadn"),t.C$Y(),t.I0R(9,"nz-form-control")(10,"input",7),t.iHE("ngModelChange",function(p){return t.kNx(a.searchParam.departmentName,p)||(a.searchParam.departmentName=p),p}),t.C$Y()()()(),t.I0R(11,"div",5)(12,"nz-form-item")(13,"nz-form-label",6),t.OEk(14,"Tr\u1ea1ng th\xe1i"),t.C$Y(),t.I0R(15,"nz-form-control")(16,"nz-select",8),t.iHE("ngModelChange",function(p){return t.kNx(a.searchParam.state,p)||(a.searchParam.state=p),p}),t.yuY(17,B,1,2,"nz-option",9),t.C$Y()()()(),t.I0R(18,"div",10)(19,"button",11),t.qCj("click",function(){return a.getDataList()}),t.wR5(20,"i",12),t.OEk(21," T\xecm ki\u1ebfm "),t.C$Y(),t.I0R(22,"button",13),t.qCj("click",function(){return a.resetForm()}),t.wR5(23,"i",14),t.OEk(24," c\xe0i l\u1ea1i "),t.C$Y()()()()(),t.I0R(25,"app-card-table-wrap",15),t.qCj("reload",function(){return a.reloadTable()}),t.I0R(26,"app-tree-table",16),t.qCj("changePageNum",function(p){return a.getDataList(p)})("changePageSize",function(p){return a.changePageSize(p)}),t.C$Y(),t.yuY(27,K,3,3,"ng-template",null,17,t.gJz),t.C$Y()(),t.yuY(29,j,3,0,"ng-template",null,18,t.gJz)(31,Z,1,1,"ng-template",null,19,t.gJz)(33,q,2,1,"ng-template",null,20,t.gJz)(35,tt,2,1,"ng-template",null,21,t.gJz)),2&o){const r=t.Gew(30);t.E7m("pageHeaderInfo",a.pageHeaderInfo),t.yG2(2),t.E7m("nzBodyStyle",t.q4q(29,nt)),t.yG2(2),t.E7m("nzGutter",t.q4q(30,et)),t.yG2(),t.E7m("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),t.yG2(5),t.OKB("ngModel",a.searchParam.departmentName),t.yG2(),t.E7m("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),t.yG2(5),t.OKB("ngModel",a.searchParam.state),t.yG2(),t.E7m("ngForOf",a.stateOptions),t.yG2(),t.E7m("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),t.yG2(),t.E7m("nzType","primary"),t.yG2(6),t.E7m("btnTpl",r)("tableTitle","Danh s\xe1ch b\u1ed9 ph\u1eadn"),t.yG2(),t.E7m("tableConfig",a.tableConfig)("tableData",a.dataList)}},dependencies:[R.Q,b.iq,b.Q9,s.y,s.sz,s.ot,s.ue,s.u,s._G,s.SC,m.WO,c.QD,c.ox,m.BN,m.qU,m.Qo,m.YZ,c.Ko,u.OA,u.cv,C.VL,C.eE,C.Mh,h.Iw,T.EV,T.Ez,U.k,v.o9,v.gn,G.Wy,G.If,S.E,L.s,M.s,h.XV,A.c,A.s],encapsulation:2,changeDetection:0})}return e})()}}]);